(function(){"use strict";var p;(function(t){t[t.Email=2]="Email",t[t.Phone=3]="Phone"})(p||(p={}));var P;(function(t){t[t.UNSET=0]="UNSET",t[t.MALE=1]="MALE",t[t.FEMALE=2]="FEMALE",t[t.OTHER=3]="OTHER"})(P||(P={}));var B;(function(t){t[t.UNSET=0]="UNSET",t[t.NEW=1]="NEW",t[t.ACTIVE=2]="ACTIVE",t[t.VERIFIED=3]="VERIFIED",t[t.BLOCKED=4]="BLOCKED"})(B||(B={}));var v;(function(t){t[t.Unset=0]="Unset",t[t.EMAIL=1]="EMAIL",t[t.PHONE=2]="PHONE",t[t.MESSENGER=3]="MESSENGER"})(v||(v={}));function O(){let t="";try{t=Intl.DateTimeFormat().resolvedOptions().timeZone}catch{}return t}function $(t){var e,n,i,o,s,d,a,y,w,c,u,l,g,b,m;return{customer:{id:"",login_type:t.loginType,login:(t.loginType===p.Email?t.email:t.phone)||"",status:0,settings:{language:t.language,news_enabled:!0,notification_channel:t.loginType===p.Phone?[v.PHONE]:t.loginType===p.Email?[v.EMAIL]:[],timezone:O()},contacts:{phone:t.phone||"",email:t.email||""},personal_info:{first_name:((e=t.additionalInfo)==null?void 0:e.firstName)||"",middle_name:((n=t.additionalInfo)==null?void 0:n.middleName)||"",last_name:((i=t.additionalInfo)==null?void 0:i.lastName)||"",gender:((o=t.additionalInfo)==null?void 0:o.gender)||P.UNSET,birth_date:(s=t.additionalInfo)==null?void 0:s.birthDate,personal_id:"",iban:""},operator_id:"",address:{country:((a=(d=t.additionalInfo)==null?void 0:d.address)==null?void 0:a.country)||"",region:((w=(y=t.additionalInfo)==null?void 0:y.address)==null?void 0:w.region)||"",city:((u=(c=t.additionalInfo)==null?void 0:c.address)==null?void 0:u.city)||"",home_address:((g=(l=t.additionalInfo)==null?void 0:l.address)==null?void 0:g.homeAddress)||"",zip_code:((m=(b=t.additionalInfo)==null?void 0:b.address)==null?void 0:m.zipCode)||""},is_email_confirmed:!1,is_phone_confirmed:!1,level:"",is_profile_filled:!1,registration_site_id:"",operating_region_id:t.region},currency:t.currency,promo_code:t.promoCode||"",password:t.password}}async function k(t,e){return fetch(`${t}/api/v1/site/traffic/mirrors`,{method:"POST",body:JSON.stringify({campaign_id:e})}).then(n=>n.json())}async function U(t,e){return fetch(`${t}/api/v1/site/traffic/mirrors/stats`,{method:"POST",body:JSON.stringify(e)})}async function j(t,e){return fetch(`https://${t}/api/v1/customer/signup`,{method:"POST",body:JSON.stringify($(e))}).then(n=>n.json())}async function z(t,e){try{const n=await k(t,e),i=await F(n);if(!i)throw new Error("No available mirrors");const o=H(n,i);return await U(t,o).catch().then(()=>{const s=i[0];if(s){const d=V(n.params);return{domain:s,path:n.path,paramsString:d}}throw new Error("No available mirrors")})}catch{throw new Error("No available mirrors")}}async function F(t){if(!t||!t.domains)return null;const e=t.domains.map(n=>q(`https://${n}/x-hash-x.js`).then(i=>i.text()).then(i=>i==="4f0bf1672ff945fb7e8d6003506e0dcb21a43c33"?n:null).catch(()=>null));return Promise.all(e).then(n=>n.filter(i=>!!i)).catch(()=>[])}async function q(t){const n=new AbortController,i=setTimeout(()=>n.abort(),1e4),o=await fetch(t,{method:"GET",signal:n.signal});return clearTimeout(i),o}function H(t,e){const n=t.domains.reduce((i,o)=>(i[o]=e.includes(o),i),{});return{pool_id:t.pool_id,domains:n}}function V(t){const e=[];return Object.entries(t).forEach(([n,i])=>{e.push(`${n}=${i}`)}),e.join("&")}function A({activeDomainData:t,isError:e,refreshToken:n}){const i=W(t,n),o=t.path.replace(/\/$/,""),s=e?"/register":o;return`https://${t.domain}${s}${i}`}function W(t,e){const n=new URL(window.location.href).searchParams,s=[(e?[...Array.from(n.entries()),["refresh_token",e]]:Array.from(n.entries())).filter(([d])=>d!=="rid").map(([d,a])=>`${d}=${a}`).join("&"),t.paramsString].filter(d=>!!d).join("&");return s?`?${s}`:""}const J="https://htzbtz.cc",K="686a47af",G={registration:"Registration",login:"Login",emailPlaceholder:"Enter your email",passwordPlaceholder:"Enter password",registerButton:"Register",loginButton:"Sign in",loading:"Loading...",waiting:"Waiting for data...",domainLoading:"Loading domain data...",domainError:"Error:",registrationError:"Registration error. Please try again later.",domainNotLoaded:"Domain data not loaded. Please try later.",registrationSuccess:"Registration successful!",emailError:"Enter a valid email",passwordError:"Password must contain at least 6 characters",termsError:"You must accept the terms of use"};function X(){return"en"}function R(){const t=G;let e=null,n=null,i=!0;const o=document.getElementById("registration-modal"),s=document.getElementById("registration-modal-backdrop"),d=document.getElementById("registration-form"),a=document.getElementById("registration-submit-btn"),y=document.getElementById("registration-domain-error"),w=document.getElementById("registration-submit-error"),c=document.getElementById("reg-email"),u=document.getElementById("reg-email-error"),l=document.getElementById("reg-password"),g=document.getElementById("reg-password-error"),b=document.getElementById("reg-terms"),m=document.getElementById("reg-terms-error"),S=document.getElementById("reg-password-toggle"),T=document.querySelectorAll(".registration-tab");function I(r){if(a)if(r==="loading")a.disabled=!0,a.textContent=t.loading;else if(r==="waiting")a.disabled=!0,a.textContent=t.waiting;else if(e){a.disabled=!1;const E=document.querySelector(".registration-tab--active"),f=E&&E.dataset.tab==="signup";a.textContent=f?t.registerButton:t.loginButton}else a.disabled=!0,a.textContent=t.domainLoading}function x(r){y&&(y.textContent=r?`${t.domainError} ${r}`:"",y.classList.toggle("hidden",!r))}function L(r){w&&(w.textContent=r||"",w.classList.toggle("hidden",!r))}function N(){u&&(u.textContent=""),g&&(g.textContent=""),m&&(m.textContent=""),L("")}async function Y(){try{e=await z(J,K),n=null,x(null)}catch(r){e=null,n=r instanceof Error?r.message:String(r),x(n)}finally{i=!1,I(e?"ready":"waiting")}}function Z(){o&&(o.classList.remove("hidden"),o.setAttribute("aria-hidden","false"))}function C(){o&&(o.classList.add("hidden"),o.setAttribute("aria-hidden","true")),N()}function D(){var h;let r=!0;const E=((h=c==null?void 0:c.value)==null?void 0:h.trim())||"",f=(l==null?void 0:l.value)||"",_=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return u&&(u.textContent=""),g&&(g.textContent=""),m&&(m.textContent=""),_.test(E)||(u&&(u.textContent=t.emailError),r=!1),f.length<6&&(g&&(g.textContent=t.passwordError),r=!1),b!=null&&b.checked||(m&&(m.textContent=t.termsError),r=!1),r}async function Q(r){var f;if(r.preventDefault(),!e){L(t.domainNotLoaded);return}if(!D())return;I("loading"),L(""),N();const E={email:((f=c==null?void 0:c.value)==null?void 0:f.trim())||"",phone:null,password:(l==null?void 0:l.value)||"",currency:"EUR",language:X(),promoCode:void 0,loginType:p.Email,region:"de"};try{const _=await j(e.domain,E),h=A({activeDomainData:e,refreshToken:_.refresh_token});h?(localStorage.setItem("was-registered","true"),window.location.href=h):(alert(t.registrationSuccess),C())}catch{if(e){const h=A({activeDomainData:e,isError:!0});if(h){window.location.href=h;return}}L(t.registrationError),I("ready")}}s&&s.addEventListener("click",C),d&&d.addEventListener("submit",Q),S&&l&&S.addEventListener("click",()=>{const r=l.type;l.type=r==="password"?"text":"password",S.textContent=r==="password"?"ðŸ™ˆ":"ðŸ‘ï¸",S.setAttribute("aria-label",r==="password"?"Hide password":"Show password")}),T.forEach(r=>{r.addEventListener("click",()=>{T.forEach(f=>f.classList.remove("registration-tab--active")),r.classList.add("registration-tab--active");const E=r.dataset.tab==="signup";a&&e&&(a.textContent=E?t.registerButton:t.loginButton)})});const M=document.querySelector(".scratch-result-cta");M&&M.addEventListener("click",Z),I(i?"loading":e?"ready":"waiting"),Y()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",R):R()})();
